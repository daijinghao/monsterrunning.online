<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You're Offline - Monster Running</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #F2F2F7;
            color: #1C1C1E;
        }
        
        .offline-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 2rem;
        }
        
        .retry-button {
            background-color: #007AFF;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .retry-button:hover {
            background-color: #0062CC;
            transform: translateY(-2px);
        }
        
        .retry-button:active {
            transform: translateY(0);
        }
        
        .cached-games {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        @media (max-width: 640px) {
            .cached-games {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex flex-col items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center">
            <div class="offline-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#007AFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M1 1l22 22"></path>
                    <path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path>
                    <path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path>
                    <path d="M10.71 5.05A16 16 0 0 1 22.58 9"></path>
                    <path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path>
                    <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                    <line x1="12" y1="20" x2="12.01" y2="20"></line>
                </svg>
            </div>
            
            <h1 class="text-2xl font-bold mb-4">You're Offline</h1>
            <p class="text-gray-600 mb-6">It looks like you lost your internet connection. Some features may be unavailable until you're back online.</p>
            
            <button class="retry-button" onclick="window.location.reload()">
                Try Again
            </button>
        </div>
        
        <div class="mt-8 w-full max-w-4xl" id="cached-content">
            <h2 class="text-xl font-bold mb-4">Available Offline</h2>
            <p class="text-gray-600 mb-6">You can still access these games while offline:</p>
            
            <div class="cached-games" id="cached-games-container">
                <!-- This will be populated by JavaScript with cached games -->
                <div class="p-4 text-center text-gray-500">
                    Looking for cached games...
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if we're still offline
        window.addEventListener('online', function() {
            window.location.reload();
        });
        
        // Attempt to show cached games
        if ('caches' in window) {
            const cachedGamesContainer = document.getElementById('cached-games-container');
            
            caches.open('monster-running-cache-v1').then(cache => {
                cache.keys().then(requests => {
                    // Filter for game pages
                    const gameRequests = requests.filter(request => {
                        const url = new URL(request.url);
                        return url.pathname.match(/\/[a-z-]+\/[a-z0-9-]+\.html$/);
                    });
                    
                    if (gameRequests.length === 0) {
                        cachedGamesContainer.innerHTML = `
                            <div class="p-4 text-center text-gray-500">
                                No games available offline. Visit some games while online to cache them for offline use.
                            </div>
                        `;
                        return;
                    }
                    
                    // Clear the container
                    cachedGamesContainer.innerHTML = '';
                    
                    // Add each cached game
                    gameRequests.forEach(request => {
                        const url = new URL(request.url);
                        const pathParts = url.pathname.split('/');
                        const gameSlug = pathParts[pathParts.length - 1].replace('.html', '');
                        const category = pathParts[pathParts.length - 2];
                        
                        // Create a nice name from the slug
                        const gameName = gameSlug
                            .split('-')
                            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                            .join(' ');
                        
                        const gameCard = document.createElement('a');
                        gameCard.href = request.url;
                        gameCard.className = 'bg-white rounded-lg shadow p-4 transition-all hover:shadow-md hover:-translate-y-1';
                        gameCard.innerHTML = `
                            <div class="aspect-video bg-gray-200 rounded-md mb-2 flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <h3 class="font-bold text-gray-900">${gameName}</h3>
                            <p class="text-xs text-gray-500 mt-1">${category.charAt(0).toUpperCase() + category.slice(1)}</p>
                        `;
                        
                        cachedGamesContainer.appendChild(gameCard);
                    });
                }).catch(error => {
                    console.error('Error fetching cached games:', error);
                    cachedGamesContainer.innerHTML = `
                        <div class="p-4 text-center text-gray-500">
                            Unable to check for cached games.
                        </div>
                    `;
                });
            });
        } else {
            // Caches API not supported
            document.getElementById('cached-content').style.display = 'none';
        }
    </script>
</body>
</html> 